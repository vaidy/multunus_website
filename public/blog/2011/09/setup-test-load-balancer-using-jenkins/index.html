
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Setup Test Load Balancer using Jenkins - Multunus Software Pvt. Ltd.</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="The main purpose of a test suite is to give fast feedback about the changes being made to the developer. Ideally the test suite should be really fast &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.multunus.com//blog/2011/09/setup-test-load-balancer-using-jenkins">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/bootstrap/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/bootstrap/responsive.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="/stylesheets/screen.css">
  <style type="text/css">
    body {
        }
    h1 {
      margin-bottom: 15px;
    }
    img {
      max-width: 100%;
    }
    .sharing, .meta, .pager {
      margin: 20px 0px 20px 0px;
    }
    
  </style>
  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Multunus Software Pvt. Ltd." type="application/atom+xml">
  <!-- jQuery Form Plugin -->
<script src="http://malsup.github.com/jquery.form.js"></script>
<!-- jQuery Form Validation Plugin -->
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script> 
<script src="/javascripts/google_form.js"></script>
  <link href='http://fonts.googleapis.com/css?family=Bitter:400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
    // Avoid conflict with ender.js.
    jQuery.noConflict();
</script>
<!-- jQuery Form Plugin -->
<script src="http://malsup.github.com/jquery.form.js"></script>
<!-- jQuery Form Validation Plugin -->
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script> 
<script src="/javascripts/google_form.js"></script>
  

</head>

<body   >
  <nav role="navigation"><div class="navbar subnav">
  <div class="container-fluid">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>        

      <div class="nav-collapse top-bar">
        <ul class="nav">
  
    <li><a class="small-logo" href="/"><img src='/images/logo_small.png' /></a></li>  
  
	<li  ><a href="/">Home</a></li>	
  <li  ><a href="/what-we-do">What We Do</a></li>
  <li  ><a href="/why-us">Why Us?</a></li>
  <li  ><a href="/careers-multunus">Careers</a></li>
  <li  class="dropdown">
    <a href="/about/history">About</a>
    <ul class="dropdown-menu">
      <li><a href="/about/history">History</a></li>
      <li><a href="/about/people">People</a></li>
    </ul>
  </li>
  <li ><a href="/blog">Our Blog</a></li>
  <li  class="dropdown">
      <a href="/contact-us/contact">Contact</a>
      <ul class="dropdown-menu">
        <li><a href="/contact-us/contact">Write to Us</a></li>
        <li><a href="/contact-us/location">Location</a></li>
      </ul>
  </li>
</ul>
<ul class="nav social-icons pull-right">
  <li id="facebook"> 
    <a href="https://www.facebook.com/multunus" title="facebook">
      <img src="/images/facebook_white_icon.png" alt="facebook" />
    </a>
  </li> 
  <li id="twitter"> 
    <a href="http://twitter.com/multunus" title="twitter">
      <img src="/images/twitter_white_icon.png" alt="twitter" />
    </a>
  </li>   

</ul>

      </div>
    </div>
</div>
</nav>
  <div class="container-fluid main-content">
    <div class="row-fluid">
      <article class="hentry span9 blog-post" role="article">
  
  <header>
    
      <h1 class="entry-title">Setup Test Load Balancer Using Jenkins</h1>
    
    
      <p class="meta">
        
  

<span class="byline author vcard">Posted by <span class="fn">KP</span></span>

        








  


<time datetime="2011-09-23T09:40:07+05:30" pubdate data-updated="true">Sep 23<span>rd</span>, 2011</time>
        

<span class="categories">
  
    <a class='category' href='/blog/categories/all-posts/'>All Posts</a>, <a class='category' href='/blog/categories/continuous-delivery/'>Continuous Delivery</a>
  
</span>


        
      </p>
    
  </header>


<div class="entry-content"><p>The main purpose of a test suite is to give fast feedback about the changes being made to the developer. Ideally the test suite should be really fast and should take no more than 10 mins to complete. But there are times when you end up with a test suit that takes 30 - 40 mins to complete. This can be really frustrating for the developers because they have to wait for 40 mins after checking in his changes to know if he broke something.</p>

<p>For this problem there are two possible solutions. Take some time from your project schedule to rewrite some part of your test suite. Although this is the ideal solution to the problem, this might not always be an option for you because of delivery deadlines. The other alternative is to throw more hardware at the problem and this is where <a href="http://test-load-balancer.github.com/">TLB </a>comes in to picture.</p>

<p>One approach to solving the problem is to partition your spec suite in to different sets and then run them paralley in different machines. The problem with this approach is that it will take a lot of trial and error before you end up with partitions that takes almost equal time to finish. Also mainting these partition as you add more tests become a head ache. This is the exact problem the <a href="http://test-load-balancer.github.com/">TLB</a> fixes.</p>

<p>A detailed description of how to setup the test load balancer is available <a href="http://test-load-balancer.github.com/doc-0_3_2/getting_started_with_tlb.html">here</a>. It should give you a very good idea about how TLB works and also about how do add load balancing to your build.</p>

<p>We are using jenkins as our CI server, so we will be concentrating on how to setup TLB on Jenkins. I am assuming that you already have the job [ to which you want to add load balancing ] configured in Jenkins.</p>

<p>The TLB setup has two main two components</p>

<div>
<ul>
    <li>TLB server</li>
    <li>Balancer</li>
</ul>
</div>


<h2>Setup TLB server</h2>


<p>Download the TLB server and install it on your CI server host [ again for detailed instruction <a href="http://test-load-balancer.github.com/doc-0_3_2/getting_started_with_tlb.html">look here</a> ]. Optionally add a service startup script so that the TLB server starts up each time you restart the server.</p>

<h2>Add balancing to your build</h2>


<p>For Rspec TLB distribution comes with a ruby gem you can install this. Also the balancer requires a hook in to you build invocation process this too is available as a rake task in TLB docs, add this to your project.</p>

<h2>Create Job Partitions</h2>


<p>The setup for the jobs which run in different partitions are exactly same, only difference between the partitions are only the subset of test executed in each partition.</p>

<p>Create as many copies of the existing job as the number of partitions that you want to run. Additionally you can name each of these jobs as &lt;job-name-n&gt; where n refers to the partition which this job is going to run. Create an dummy job and configure the post build task so that all the partitioned jobs will be triggered simultaneously.</p>
</div>


  <footer>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.multunus.com//blog/2011/09/setup-test-load-balancer-using-jenkins/" data-via="multunus" data-counturl="http://www.multunus.com//blog/2011/09/setup-test-load-balancer-using-jenkins/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    
    <section>
      <h1>Comments</h1>
      <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </section>
    
    <ul class="pager">
      
      <li class="previous"><a class="basic-alignment left"
        href="/blog/2011/09/rebuilding-in-jenkins/" title="Previous Post:
        Rebuilding in Jenkins">&laquo; Rebuilding in Jenkins</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
      <li class="next"><a class="basic-alignment right" href="/blog/2011/09/continuous-delivery-for-android-apps-part-1/"
        title="Next Post: Continuous Delivery for Android Apps - Part 1">Continuous Delivery for Android Apps - Part 1
        &raquo;</a></li>
      
    </ul>
  </footer>
  

<script type="text/javascript">
      var disqus_shortname = 'multunus';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.multunus.com//blog/2011/09/setup-test-load-balancer-using-jenkins/';
        var disqus_url = 'http://www.multunus.com//blog/2011/09/setup-test-load-balancer-using-jenkins/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</article>

<aside class="sidebar-nav span3">
  <h3>Categories</h3>
<ul id="category-list">
	<li><a href='/blog/categories/all-posts'>All Posts</a></li><li><a href='/blog/categories/android'>Android</a></li><li><a href='/blog/categories/business'>Business</a></li><li><a href='/blog/categories/continuous-delivery'>Continuous Delivery</a></li><li><a href='/blog/categories/process'>Process</a></li><li><a href='/blog/categories/rails'>Rails</a></li><li><a href='/blog/categories/technology'>Technology</a></li>
</ul>

</aside> 
    </div>
  </div>
  <div class="container-fluid dark-background">
      <div class="row-fluid">
        <div class="span4 featured-posts">
          <div class="header">Featured Posts</div>
<ul id="featured-posts">
  
    
  
    
  
    
  
    
      <li class="post">
        <a href="/blog/2012/01/a-sneak-peak-into-mobile-app-opportunities-in-2012/">A sneak peek into Mobile App Opportunities in 2012</a>
      </li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class="post">
        <a href="/blog/2011/09/continuous-delivery-for-android-apps-part-1/">Continuous Delivery for Android Apps - Part 1</a>
      </li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class="post">
        <a href="/blog/2011/07/continuous-delivery-using-jenkins-build-pipeline/">Continuous Delivery - Part 1: Our Jenkins Build Pipeline setup</a>
      </li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class="post">
        <a href="/blog/2011/02/software-development-as-a-balance/">A Macro Level Perspective of Software Development</a>
      </li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</ul>

        </div>
        <div class="span4 tumblr-feed">
          <div class="header">Our Daily Voice</div>
<ul id="tumblr_post">
  <li class="loading">Fetching...</li>
</ul>
<div id="continue-reading"><a href="http://multunus.tumblr.com/">Continue reading at our tumblog</a></div>
<script type="text/javascript">
  $(document).ready(function(){
    getTumblrPost("multunus", 1);
  });
</script>
<script src="/javascripts/asides/tumblr.js" type="text/javascript"> </script>

        </div>
        <div class="span4 twitter-feed">
          
  <div class='header'>@multunus</div>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $(document).ready(function(){
      getTwitterFeed("multunus", 5, false);
    });
  </script>
  <script src="/javascripts/asides/twitter.js" type="text/javascript"> </script>


        </div>         
      </div>
    </div>
  <footer role="contentinfo" class="page-footer">
<div class = "navbar footer-navbar">
  <div class = "container-fluid">
    <div class="nav-collapse footer-container">
      <ul class="nav"><li class="copyright">&copy;2012 Copyright by Multunus Software Private Limited.</li></ul>

<ul class="nav pull-right">
  <li><a href="/">Home</a></li>	
  <li><a href="/what-we-do">What We Do</a></li>
  <li><a href="/why-us">Why Us?</a></li>
  <li><a href="/careers-multunus">Careers</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/blog">Our Blog</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

    </div>
  </div>
</div>
</footer>
</body>
</html>
